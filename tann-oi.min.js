/*! tann-oi@v0.1.0 - 2014-06-28 */
!function(){"use strict";var a,b,c;a=function(_){var a;return a=function(){this._engine={},this.parameter_style="separate"},a.prototype.init=function(a){var b,c,d;if(_.isUndefined(a))throw new Error("No pub-sub source provided");if(c=_.functions(a),b=_.reduce(c,function(b,c){return b[c]=a[c],b},{}),this._engine.on=this._getOnFunction(b),this._engine.off=this._getOffFunction(b),this._engine.trigger=this._getTriggerFunction(b),!_.isFunction(this._engine.on)||!_.isFunction(this._engine.off)||!_.isFunction(this._engine.trigger))throw new Error("Incompatible pub-sub source provided");return d=this._getOnceFunction(b),_.isFunction(d)||(d=this._createOnceFunction()),this._engine.once=d,this._detectWildcardEventBinding(),this._detectEventParameterStyle(),this},a.prototype.clear=function(){return this._engine={},this.parameter_style="separate",this},a.prototype.on=function(){return this},a.prototype.off=function(){return this},a.prototype.trigger=function(){return this},a.prototype._getFunctionFromList=function(a,b){var c=_.pick.apply(_,[b].concat(a)),d=_.values(c);return 0===d.length?null:d[0]},a.prototype._getOnFunction=function(a){var b=["on","bind","subscribe"];return this._getFunctionFromList(b,a)},a.prototype._getOffFunction=function(a){var b=["off","unbind","unsubscribe"];return this._getFunctionFromList(b,a)},a.prototype._getTriggerFunction=function(a){var b=["trigger","fire","publish"];return this._getFunctionFromList(b,a)},a.prototype._getOnceFunction=function(a){var b=["once","one"];return this._getFunctionFromList(b,a)},a.prototype._createOnceFunction=function(){return function(){}},a.prototype._detectWildcardEventBinding=function(){var a=function(){this.called=!0};this._engine.on("fd-1:*",a),this._engine.trigger("fd-1:123"),_.defer(_.bind(function(){a.called!==!0},this))},a.prototype._detectEventParameterStyle=function(){var a=_.bind(function(a,b){"one"===a&&"two"===b?this.parameter_style="combined":_.isEqual(a,["one","two"])&&"three"===b&&(this.parameter_style="separate")},this);this._engine.on("fd-2:123",a),this._engine.trigger("fd-2:123",["one","two"],"three","four")},new a},"undefined"!=typeof module&&(module.exports=a(require("underscore"))),"undefined"!=typeof define?define(["underscore"],function(_){return a(_)}):"undefined"!=typeof window&&(b=a(window._),c=function(){var a=window.tannoi;return function(){return b===window.tannoi&&(window.tannoi=a),b}}(),b.noConflict=c,window.tannoi=b)}();